var busy=function(s){"use strict";let t;t="undefined"!=typeof window?window.WebSocket:require("ws");const i=(s,t)=>{setTimeout(()=>{1===s.readyState?null!==t&&t():i(s,t)},5)};return s.Client=class{constructor(s){this.address=s,this.open=!1,this.queue={},this.id=0,this.notifications=(()=>{}),this.ws=new t(s),this.ws.addEventListener("message",s=>{const t=JSON.parse(s.data);this.queue[t.id]?this.queue[t.id](null,t.result):this.notifications(null,t)}),this.ws.addEventListener("open",()=>{this.open=!0}),this.ws.addEventListener("close",()=>{this.open=!1})}subscribe(s){this.notifications=s}send(s){i(this.ws,()=>{this.ws.send(JSON.stringify(s))})}call(s,t=[],i){this.id++,this.queue[this.id]=i,this.send({id:this.id,method:"call",jsonrpc:"2.0",params:["database_api",s,[t]]})}},s}({});
